# v1.2 Manual Testing Checklist

**Branch**: `feature/v1.2-hard-delete-wallet-summary`  
**Testing Date**: _________________  
**Tester**: _________________

---

## 🚀 Pre-Testing Setup

### 1. Start Development Server

```bash
cd /Users/rezel/Cursor/Wallet/APP

# Kill any existing server
pkill -f "next dev"

# Start fresh
pnpm dev
```

✅ **Expected**: Server starts at `http://localhost:3000`  
✅ **Check**: No compilation errors in terminal

---

### 2. Verify Database Migration

```bash
# Run the check script
node scripts/check-schema.js
```

✅ **Expected Output**:
```
✅ is_archived column successfully removed from wallets
✅ is_archived column successfully removed from categories

Foreign key constraints:
  - transactions_wallet_id_wallets_id_fk: ON DELETE CASCADE
  - transactions_category_id_categories_id_fk: ON DELETE SET NULL
  - transactions_transfer_group_id_transfer_groups_id_fk: ON DELETE CASCADE
```

---

### 3. Seed Test Data (Optional - if needed)

```bash
pnpm db:seed
```

✅ **Expected**: Creates wallets, categories, and sample transactions

---

## 📝 TESTING CHECKLIST

---

## PART 1: API Endpoints Testing

### Test 1.1: GET /api/wallets
**URL**: `http://localhost:3000/api/wallets`

- [ ] Open URL in browser
- [ ] Response is JSON array
- [ ] Each wallet has: `id`, `name`, `currency`, `createdAt`
- [ ] **VERIFY**: No `isArchived` field present ✅

**Expected Response Example**:
```json
[
  {
    "id": 1,
    "name": "BCA",
    "currency": "IDR",
    "createdAt": "2024-10-17T..."
  }
]
```

---

### Test 1.2: GET /api/categories
**URL**: `http://localhost:3000/api/categories`

- [ ] Open URL in browser
- [ ] Response is JSON array
- [ ] Each category has: `id`, `name`, `type`, `createdAt`
- [ ] **VERIFY**: No `isArchived` field present ✅

---

### Test 1.3: GET /api/wallets/[id]/summary (NEW ENDPOINT)
**URL**: `http://localhost:3000/api/wallets/1/summary`

- [ ] Open URL in browser
- [ ] Response contains:
  - [ ] `walletId` (number)
  - [ ] `income` (number)
  - [ ] `expense` (number)
  - [ ] `net` (number = income - expense)
  - [ ] `uncategorized` (number)

**Expected Response Example**:
```json
{
  "walletId": 1,
  "income": 5000000,
  "expense": 200000,
  "net": 4800000,
  "uncategorized": 0
}
```

**Additional Tests**:
- [ ] Test with date filter: `/api/wallets/1/summary?from=2024-10-01&to=2024-10-31`
- [ ] Verify `from` and `to` fields appear in response

---

### Test 1.4: GET /api/balances
**URL**: `http://localhost:3000/api/balances`

- [ ] Open URL in browser
- [ ] Response is array with balance per wallet
- [ ] Balance calculation looks correct

---

### Test 1.5: Verify Deprecated Endpoints Return 404
**URLs to test**:
- `http://localhost:3000/api/wallets/1/archive` (should be 404)
- `http://localhost:3000/api/categories/1/archive` (should be 404)

- [ ] Both return 404 or "Not Found"
- [ ] **VERIFY**: Archive endpoints no longer exist ✅

---

## PART 2: Wallets Page Testing

### Test 2.1: Wallets Page Loads
**URL**: `http://localhost:3000/wallets`

- [ ] Page loads without errors
- [ ] Check browser console - no JavaScript errors
- [ ] Wallet cards display

---

### Test 2.2: Wallet Summary Display
**On each wallet card, verify**:

- [ ] **Income** displayed in green with `+Rp` format
- [ ] **Expense** displayed in red with `-Rp` format
- [ ] **Net** displayed (green if positive, red if negative)
- [ ] **Uncategorized** displayed (gray, only if > 0)
- [ ] Values match API response from `/api/wallets/[id]/summary`

**Visual Check**:
- [ ] Card has rounded corners (20px radius)
- [ ] Dark theme applied (#1E1E1E background)
- [ ] Divider line between sections
- [ ] Proper spacing and padding

---

### Test 2.3: Delete Button - UI Behavior
**Steps**:
1. [ ] Click "Delete wallet" link on a test wallet
2. [ ] **VERIFY**: Confirmation buttons appear
   - [ ] "Confirm Delete" button (red, rounded-full)
   - [ ] "Cancel" button (gray, rounded-full)
3. [ ] Click "Cancel"
   - [ ] **VERIFY**: Returns to normal state (delete link shows again)
4. [ ] Click "Delete wallet" again
5. [ ] Hover over buttons
   - [ ] **VERIFY**: Brightness increases on hover
6. [ ] Click button (active state)
   - [ ] **VERIFY**: Scale effect (button shrinks slightly)

---

### Test 2.4: Create New Wallet
**Steps**:
1. [ ] Click "+ Add" button
2. [ ] Form appears
3. [ ] Enter wallet name: "Test Wallet Delete"
4. [ ] Click "Create wallet"
5. [ ] **VERIFY**: New wallet appears in list with summary stats
6. [ ] **VERIFY**: Summary shows 0 for income/expense/net

---

## PART 3: CASCADE DELETE Testing (CRITICAL)

### Test 3.1: Setup Test Data
**Preparation**:
1. [ ] Create a test wallet: "Delete Test Wallet"
2. [ ] Create 2-3 transactions for this wallet via Transactions page
3. [ ] Note the wallet ID (check API: `/api/wallets`)
4. [ ] Note transaction IDs (check API: `/api/transactions?wallet_id=[ID]`)

---

### Test 3.2: Verify Transactions Exist
**Before deletion**:
```bash
# Run this in terminal (replace [ID] with wallet ID)
curl http://localhost:3000/api/transactions?wallet_id=[ID]
```

- [ ] Transactions returned in JSON
- [ ] Note count of transactions

---

### Test 3.3: Delete Wallet with Transactions
**Steps**:
1. [ ] Go to `/wallets`
2. [ ] Find "Delete Test Wallet"
3. [ ] Click "Delete wallet"
4. [ ] Click "Confirm Delete"
5. [ ] **VERIFY**: Success alert appears
6. [ ] **VERIFY**: Wallet removed from list

---

### Test 3.4: Verify CASCADE - Transactions Deleted
**After wallet deletion**:

**Option A: Via API**
```bash
curl http://localhost:3000/api/transactions?wallet_id=[DELETED_ID]
```
- [ ] Returns empty array `[]`
- [ ] **VERIFY**: All transactions CASCADE deleted ✅

**Option B: Via Database**
```bash
node scripts/check-data.js
```
- [ ] Transaction count decreased
- [ ] No orphaned transactions

---

## PART 4: Categories Page Testing

### Test 4.1: Categories Page Loads
**URL**: `http://localhost:3000/categories`

- [ ] Page loads without errors
- [ ] Expense categories section visible
- [ ] Income categories section visible
- [ ] **VERIFY**: No "Archive" buttons (should be "Delete")

---

### Test 4.2: Delete Button Display
**Visual Check**:
- [ ] "Delete category" link visible (red text, underlined)
- [ ] No "Archived" badge visible
- [ ] Category type badge shows (Expense red / Income green)

---

### Test 4.3: Create Test Category
**Steps**:
1. [ ] Click "+ Add" button
2. [ ] Enter name: "Test Delete Category"
3. [ ] Select type: "Expense"
4. [ ] Click "Create category"
5. [ ] **VERIFY**: New category appears in Expense section

---

## PART 5: SET NULL Testing (CRITICAL)

### Test 5.1: Setup Test Data
**Preparation**:
1. [ ] Go to Transactions page
2. [ ] Create 2-3 transactions using "Test Delete Category"
3. [ ] Note transaction IDs
4. [ ] Verify transactions have `category_id` set

**Via API Check**:
```bash
curl http://localhost:3000/api/transactions?category_id=[CAT_ID]
```
- [ ] Transactions show with category name

---

### Test 5.2: Delete Category with Transactions
**Steps**:
1. [ ] Go to `/categories`
2. [ ] Find "Test Delete Category"
3. [ ] Click "Delete category"
4. [ ] Click "Confirm Delete"
5. [ ] **VERIFY**: Alert message mentions "uncategorized"
6. [ ] **VERIFY**: Category removed from list

---

### Test 5.3: Verify SET NULL - Transactions Remain
**After category deletion**:

**Check transactions still exist**:
```bash
curl http://localhost:3000/api/transactions
```

- [ ] Transactions still present in list
- [ ] **VERIFY**: `categoryId` is `null`
- [ ] **VERIFY**: `categoryName` is `null` or shows "Uncategorized"
- [ ] **VERIFY**: Transactions NOT deleted ✅

**Via Transactions Page**:
1. [ ] Go to `/transactions`
2. [ ] Find the test transactions
3. [ ] **VERIFY**: They show as "Uncategorized"
4. [ ] **VERIFY**: All other fields intact (amount, wallet, date)

---

## PART 6: UI/UX Testing

### Test 6.1: Design System Compliance

**Dark Theme**:
- [ ] Background: Dark (#0D0D0D)
- [ ] Cards: Slightly lighter (#1E1E1E)
- [ ] Text: White (#FFFFFF)
- [ ] Muted text: Gray (#A3A3A3)

**Colors**:
- [ ] Accent: Purple (#A78BFA) - used for "+ Add" buttons
- [ ] Positive: Green (#22C55E) - income amounts
- [ ] Negative: Red (#EF4444) - expense amounts, delete buttons

**Rounded Corners**:
- [ ] Cards: 20px border radius
- [ ] Buttons: Fully rounded (pill shape)

**Transitions**:
- [ ] Hover effects smooth (200ms)
- [ ] Button hover: brightness increase
- [ ] Button active: scale down effect

---

### Test 6.2: Responsive Behavior
**Resize browser window**:
- [ ] Layout adjusts properly
- [ ] Cards don't break
- [ ] Buttons remain accessible
- [ ] Text doesn't overflow

---

### Test 6.3: Confirmation Dialogs
**Test on both Wallets and Categories**:
- [ ] Click delete → confirmation appears
- [ ] Click outside → nothing happens (stays in confirm mode)
- [ ] Cancel button works
- [ ] Confirm button works
- [ ] No double-confirmation prompts

---

## PART 7: Data Integrity Tests

### Test 7.1: Wallet Summary Accuracy
**Manual calculation**:
1. [ ] Pick a wallet
2. [ ] Check API: `/api/transactions?wallet_id=[ID]`
3. [ ] Manually sum:
   - Income transactions (type='income')
   - Expense transactions (type='expense')
   - Exclude transfers (transfer_group_id != null)
4. [ ] Compare with `/api/wallets/[ID]/summary`
5. [ ] **VERIFY**: Numbers match ✅

---

### Test 7.2: Transfer Exclusion
**Verify transfers don't affect summary**:
1. [ ] Create a transfer transaction
2. [ ] Check wallet summary before and after
3. [ ] **VERIFY**: Transfer amount NOT included in income/expense
4. [ ] **VERIFY**: Net balance reflects transfer (via balances API)

---

### Test 7.3: Uncategorized Amount
**Test scenario**:
1. [ ] Create transaction without category (if possible)
2. [ ] OR delete category with transactions (from Test 5)
3. [ ] Check wallet summary
4. [ ] **VERIFY**: `uncategorized` field shows correct total

---

## PART 8: Error Handling

### Test 8.1: Delete Non-Existent Wallet
**Via API (optional)**:
```bash
curl -X POST http://localhost:3000/api/... 
# (test with Server Action if possible)
```
- [ ] Error message shown
- [ ] App doesn't crash

---

### Test 8.2: Invalid Summary Request
**URL**: `http://localhost:3000/api/wallets/99999/summary`

- [ ] Returns 404 or appropriate error
- [ ] Error message: "Wallet not found"

---

## PART 9: Performance Check

### Test 9.1: Load Time
- [ ] Wallets page loads in < 2 seconds
- [ ] Categories page loads in < 2 seconds
- [ ] Summary API responds in < 500ms

---

### Test 9.2: Multiple Wallets
**If you have many wallets**:
- [ ] Page doesn't lag
- [ ] Summaries load (they fetch in parallel)
- [ ] No visible loading spinner needed (or shows briefly)

---

## 📊 FINAL VERIFICATION

### Checklist Summary

**Database Schema** (from Part 1):
- [ ] ✅ `is_archived` columns removed
- [ ] ✅ Foreign key constraints correct (CASCADE, SET NULL)

**New Features** (from Part 2):
- [ ] ✅ Wallet summary displays income/expense/net/uncategorized
- [ ] ✅ Summary API endpoint works

**Critical Behaviors** (from Part 3 & 5):
- [ ] ✅ CASCADE delete: wallet deletion removes transactions
- [ ] ✅ SET NULL: category deletion keeps transactions (uncategorized)

**UI/UX** (from Part 6):
- [ ] ✅ Design system followed (dark theme, colors, rounded corners)
- [ ] ✅ Transitions and hover effects work
- [ ] ✅ Confirmation dialogs work properly

**Deprecated Features Removed**:
- [ ] ✅ No "Archive" buttons in UI
- [ ] ✅ Archive API endpoints return 404
- [ ] ✅ No `isArchived` fields in API responses

---

## 🐛 ISSUES FOUND

**Document any issues here**:

| # | Test | Issue Description | Severity |
|---|------|------------------|----------|
| 1 |      |                  | High/Med/Low |
| 2 |      |                  |          |
| 3 |      |                  |          |

---

## ✅ SIGN-OFF

- [ ] All critical tests passed (CASCADE, SET NULL, Summary API)
- [ ] All UI tests passed (design, functionality)
- [ ] No major issues found OR issues documented above
- [ ] Ready for production deployment

**Tested by**: _________________  
**Date**: _________________  
**Signature**: _________________

---

## 🚀 Next Steps After Testing

If all tests pass:
```bash
# 1. Commit test results (optional)
git add V1.2_MANUAL_TESTING_CHECKLIST.md
git commit -m "test: v1.2 manual testing completed"

# 2. Merge to main
git checkout main
git merge feature/v1.2-hard-delete-wallet-summary
git push origin main

# 3. Deploy to production
# (follow deployment guide in V1.2_IMPLEMENTATION_SUMMARY.md)
```

---

*Last updated: October 18, 2024*
